load("//bazel:build.bzl", "redpanda_cc_library")

package(default_visibility = ["//visibility:public"])

redpanda_cc_library(
    name = "cloud_roles",
    srcs = [
        "apply_abs_credentials.cc",
        "apply_abs_credentials.h",
        "apply_abs_oauth_credentials.cc",
        "apply_abs_oauth_credentials.h",
        "apply_aws_credentials.cc",
        "apply_aws_credentials.h",
        "apply_credentials.cc",
        "apply_gcp_credentials.cc",
        "apply_gcp_credentials.h",
        "aws_refresh_impl.cc",
        "aws_refresh_impl.h",
        "aws_sts_refresh_impl.cc",
        "aws_sts_refresh_impl.h",
        "azure_aks_refresh_impl.cc",
        "azure_aks_refresh_impl.h",
        "azure_vm_refresh_impl.cc",
        "azure_vm_refresh_impl.h",
        "gcp_refresh_impl.cc",
        "gcp_refresh_impl.h",
        "probe.cc",
        "refresh_credentials.cc",
        "request_response_helpers.cc",
        "request_response_helpers.h",
        "signature.cc",
        "signature.h",
        "types.cc",
    ],
    hdrs = [
        "include/cloud_roles/apply_credentials.h",
        "include/cloud_roles/logger.h",
        "include/cloud_roles/probe.h",
        "include/cloud_roles/refresh_credentials.h",
        "include/cloud_roles/types.h",
    ],
    # for ada
    exclude_layering_check = True,
    strip_include_prefix = "include",
    deps = [
        "//src/v/base",
        "//src/v/bytes",
        "//src/v/bytes:iobuf",
        "//src/v/bytes:iostream",
        "//src/v/bytes:streambuf",
        "//src/v/config",
        "//src/v/hashing:secure",
        "//src/v/http",
        "//src/v/json",
        "//src/v/metrics",
        "//src/v/model",
        "//src/v/net",
        "//src/v/ssx:future_util",
        "//src/v/ssx:sformat",
        "//src/v/utils:base64",
        "//src/v/utils:file_io",
        "//src/v/utils:named_type",
        "@abseil-cpp//absl/strings",
        "@ada",
        "@boost//:algorithm",
        "@boost//:property_tree",
        "@fmt",
        "@rapidjson",
        "@seastar",
    ],
)
